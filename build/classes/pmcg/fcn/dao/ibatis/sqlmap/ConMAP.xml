<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Con">
	<typeAlias alias="ConVO" type="pmcg.fcn.domain.ConVO" />

	<resultMap id="mapComplexQuerySimple" class="ConVO">
		<result property="iddcon" column="iddcon" />
		<result property="trccon" column="trccon" />
		<result property="crccon" column="crccon" />
		<result property="snccon" column="snccon" />
		<result property="tcrcon" column="tcrcon" />
		<result property="dcrcon" column="dcrcon" />
		<result property="ufrcon" column="ufrcon" />
		<result property="cpfcon" column="cpfcon" />
		<result property="nomcon" column="nomcon" />
		<result property="dtpcon" column="dtpcon" />
		<result property="dnrcon" column="dnrcon" />
		<result property="doecon" column="doecon" />
		<result property="duocon" column="duocon" />
		<result property="dexcon" column="dexcon" />
		<result property="edrcon" column="edrcon" />
		<result property="usualt" column="usualt" />
		<result property="datalt" column="datalt" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="ConVO">
		<result property="iddcon" column="iddcon" />
		<result property="trccon" column="trccon" />
		<result property="crccon" column="crccon" />
		<result property="snccon" column="snccon" />
		<result property="tcrcon" column="tcrcon" />
		<result property="dcrcon" column="dcrcon" />
		<result property="ufrcon" column="ufrcon" />
		<result property="cpfcon" column="cpfcon" />
		<result property="nomcon" column="nomcon" />
		<result property="dtpcon" column="dtpcon" />
		<result property="dnrcon" column="dnrcon" />
		<result property="doecon" column="doecon" />
		<result property="duocon" column="duocon" />
		<result property="dexcon" column="dexcon" />
		<result property="edrcon" column="edrcon" />
		<result property="usualt" column="usualt" />
		<result property="datalt" column="datalt" />
		
		<result property="endContador" column="endcontador" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncon WHERE iddcon = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT c.*, fcn.getEndereco(c.edrcon) as endcontador 
		FROM 
			fcn.fcncon c
		WHERE iddcon = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="ConVO" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncon
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcon" prepend=" AND ">
				iddcon = #iddcon:NUMERIC#
			</isNotNull>
			<isNotNull property="trccon" prepend=" AND ">
				trccon ILIKE '%' || #trccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="crccon" prepend=" AND ">
				crccon ILIKE '%' || #crccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="snccon" prepend=" AND ">
				snccon ILIKE '%' || #snccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tcrcon" prepend=" AND ">
				tcrcon ILIKE '%' || #tcrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dcrcon" prepend=" AND "> to_char(dcrcon,'dd/MM/yyyy') =
				to_char(#dcrcon:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="ufrcon" prepend=" AND ">
				ufrcon ILIKE '%' || #ufrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfcon" prepend=" AND ">
				cpfcon ILIKE '%' || #cpfcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nomcon" prepend=" AND ">
				nomcon ILIKE '%' || #nomcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dtpcon" prepend=" AND ">
				dtpcon ILIKE '%' || #dtpcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnrcon" prepend=" AND ">
				dnrcon ILIKE '%' || #dnrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="doecon" prepend=" AND ">
				doecon ILIKE '%' || #doecon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="duocon" prepend=" AND ">
				duocon ILIKE '%' || #duocon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dexcon" prepend=" AND ">
				dexcon ILIKE '%' || #dexcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="edrcon" prepend=" AND ">
				edrcon = #edrcon:NUMERIC#
			</isNotNull>
			<isNotNull property="usualt" prepend=" AND ">
				usualt ILIKE '%' || #usualt:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="ConVO" resultMap="mapComplexQuery">
		SELECT c.*, fcn.getEndereco(c.edrcon) as endcontador 
		FROM fcn.fcncon c
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcon" prepend=" AND "> iddcon = #iddcon:NUMERIC#
			</isNotNull>
			<isNotNull property="trccon" prepend=" AND ">
				trccon ILIKE '%' || #trccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="crccon" prepend=" AND ">
				crccon ILIKE '%' || #crccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="snccon" prepend=" AND ">
				snccon ILIKE '%' || #snccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tcrcon" prepend=" AND ">
				tcrcon ILIKE '%' || #tcrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dcrcon" prepend=" AND "> to_char(dcrcon,'dd/MM/yyyy') =
				to_char(#dcrcon:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="ufrcon" prepend=" AND ">
				ufrcon ILIKE '%' || #ufrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfcon" prepend=" AND ">
				cpfcon ILIKE '%' || #cpfcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nomcon" prepend=" AND ">
				nomcon ILIKE '%' || #nomcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dtpcon" prepend=" AND ">
				dtpcon ILIKE '%' || #dtpcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnrcon" prepend=" AND ">
				dnrcon ILIKE '%' || #dnrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="doecon" prepend=" AND ">
				doecon ILIKE '%' || #doecon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="duocon" prepend=" AND ">
				duocon ILIKE '%' || #duocon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dexcon" prepend=" AND ">
				dexcon ILIKE '%' || #dexcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="edrcon" prepend=" AND "> edrcon = #edrcon:NUMERIC#
			</isNotNull>
			<isNotNull property="usualt" prepend=" AND ">
				usualt ILIKE '%' || #usualt:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncon
	</select>

	<insert id="insReg" parameterClass="ConVO">
		<selectKey keyProperty="iddcon" resultClass="Long">
			SELECT NEXTVAL('fcn.seqcon')
		</selectKey>
		INSERT INTO
		fcn.fcncon(iddcon,trccon,crccon,snccon,tcrcon,dcrcon,ufrcon,cpfcon,nomcon,dtpcon,dnrcon,doecon,duocon,dexcon,edrcon,usualt,datalt)
		VALUES (#iddcon:NUMERIC#, UPPER(#trccon:VARCHAR#), UPPER(#crccon:VARCHAR#), UPPER(#snccon:VARCHAR#),
		UPPER(#tcrcon:VARCHAR#),#dcrcon:TIMESTAMP#, UPPER(#ufrcon:VARCHAR#), UPPER(#cpfcon:VARCHAR#), UPPER(#nomcon:VARCHAR#),
		UPPER(#dtpcon:VARCHAR#), UPPER(#dnrcon:VARCHAR#), UPPER(#doecon:VARCHAR#), UPPER(#duocon:VARCHAR#),
		UPPER(#dexcon:VARCHAR#),#edrcon:NUMERIC#, UPPER(#usualt:VARCHAR#),now() )
	</insert>

	<update id="updRegByCod" parameterClass="ConVO">
		UPDATE fcn.fcncon SET trccon= UPPER(#trccon:VARCHAR#),crccon= UPPER(#crccon:VARCHAR#),snccon= UPPER(#snccon:VARCHAR#),tcrcon=
		UPPER(#tcrcon:VARCHAR#),dcrcon= #dcrcon:TIMESTAMP#,ufrcon= UPPER(#ufrcon:VARCHAR#),cpfcon=
		UPPER(#cpfcon:VARCHAR#),nomcon= UPPER(#nomcon:VARCHAR#),dtpcon= UPPER(#dtpcon:VARCHAR#),dnrcon=
		UPPER(#dnrcon:VARCHAR#),doecon= UPPER(#doecon:VARCHAR#),duocon= UPPER(#duocon:VARCHAR#),dexcon=
		UPPER(#dexcon:VARCHAR#),edrcon= #edrcon:NUMERIC#,usualt= UPPER(#usualt:VARCHAR#),datalt= now() WHERE iddcon =
		#iddcon:NUMERIC#
	</update>
	
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM fcn.fcncon WHERE iddcon = #value:NUMERIC#
	</delete>
	
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM fcn.fcncon WHERE iddcon in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="ConVO" resultClass="Integer">
		SELECT count(iddcon) FROM fcn.fcncon
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcon" prepend=" AND "> iddcon = #iddcon:NUMERIC#
			</isNotNull>
			<isNotNull property="trccon" prepend=" AND ">
				trccon ILIKE '%' || #trccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="crccon" prepend=" AND ">
				crccon ILIKE '%' || #crccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="snccon" prepend=" AND ">
				snccon ILIKE '%' || #snccon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tcrcon" prepend=" AND ">
				tcrcon ILIKE '%' || #tcrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dcrcon" prepend=" AND "> to_char(dcrcon,'dd/MM/yyyy') =
				to_char(#dcrcon:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="ufrcon" prepend=" AND ">
				ufrcon ILIKE '%' || #ufrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfcon" prepend=" AND ">
				cpfcon ILIKE '%' || #cpfcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nomcon" prepend=" AND ">
				nomcon ILIKE '%' || #nomcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dtpcon" prepend=" AND ">
				dtpcon ILIKE '%' || #dtpcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnrcon" prepend=" AND ">
				dnrcon ILIKE '%' || #dnrcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="doecon" prepend=" AND ">
				doecon ILIKE '%' || #doecon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="duocon" prepend=" AND ">
				duocon ILIKE '%' || #duocon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dexcon" prepend=" AND ">
				dexcon ILIKE '%' || #dexcon:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="edrcon" prepend=" AND "> edrcon = #edrcon:NUMERIC#
			</isNotNull>
			<isNotNull property="usualt" prepend=" AND ">
				usualt ILIKE '%' || #usualt:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>
</sqlMap> 
 