<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Logradouro">
	<typeAlias alias="LogradouroVO" type="pmcg.imti.domain.LogradouroVO" />

	<select id="getRegByCod" parameterClass="Long" resultClass="LogradouroVO">
		SELECT 
			log.chave_logradouro_dne, log.nome_ofi_logradouro as
			logradouro,log.tipo_ofi_logradouro,
			log.sigla_uf as uf, uf.nome_oficial_uf, bai.nome_ofi_bai as bairro,
			loc.nome_ofi_localidade ,log.cep_logradouro as cep,log.sigla_uf
		FROM 
			dne.dne_gu_logradouros log
			INNER JOIN dne.dne_gu_bairros bai ON log.chave_bai_ini_dne = bai.chave_bai_dne
			INNER JOIN dne.dne_gu_localidades loc ON bai.chave_loc_dne = loc.chave_loc_dne
			INNER JOIN dne.dne_gu_unidades_federacao uf ON uf.sigla_uf = log.sigla_uf
		WHERE 
			log.chave_logradouro_dne=#value:NUMERIC#
			and loc.sigla_uf='MS' and loc.nome_ofi_localidade ='Campo Grande'
	</select>

	<select id="getRegByCep" parameterClass="String" resultClass="LogradouroVO">
		SELECT 
			log.chave_logradouro_dne, log.nome_ofi_logradouro as logradouro, log.tipo_ofi_logradouro as tipo_logradouro,
			log.sigla_uf as uf, uf.nome_oficial_uf, bai.nome_ofi_bai as bairro,
			loc.nome_ofi_localidade as cidade ,log.cep_logradouro as cep, log.sigla_uf
		FROM 
			dne.dne_gu_logradouros log
			INNER JOIN dne.dne_gu_bairros bai ON log.chave_bai_ini_dne = bai.chave_bai_dne
			INNER JOIN dne.dne_gu_localidades loc ON bai.chave_loc_dne = loc.chave_loc_dne
			INNER JOIN dne.dne_gu_unidades_federacao uf ON uf.sigla_uf = log.sigla_uf
		WHERE 
			log.cep_logradouro = #value:VARCHAR#
	</select>
	
	<select id="getCepByChave" parameterClass="String" resultClass="LogradouroVO">
		SELECT 
			chave_logradouro_dne 
		from 
			dne.dne_gu_logradouros
		where 
			cep_logradouro = #value:VARCHAR#
	</select>


	<select id="getRegByCEPdeCampoGrande" parameterClass="String" resultClass="LogradouroVO">
		SELECT 
			log.chave_logradouro_dne,log.nome_ofi_logradouro as
			logradouro,log.tipo_ofi_logradouro,loc.nome_ofi_localidade as cidade,
			log.sigla_uf as uf, uf.nome_oficial_uf, bai.nome_ofi_bai as bairro,
			loc.nome_ofi_localidade ,log.cep_logradouro as cep,log.sigla_uf
		FROM 
			dne.dne_gu_logradouros log
			INNER JOIN dne.dne_gu_bairros bai ON log.chave_bai_ini_dne = bai.chave_bai_dne
			INNER JOIN dne.dne_gu_localidades loc ON bai.chave_loc_dne = loc.chave_loc_dne
			INNER JOIN dne.dne_gu_unidades_federacao uf ON uf.sigla_uf = log.sigla_uf
		WHERE 
			log.cep_logradouro = #value:VARCHAR#
			and loc.sigla_uf='MS'
	</select>

	<select id="getCountByRua" parameterClass="HashMap" resultClass="Integer">
		SELECT 
			count(*)
		FROM 
			dne.dne_gu_logradouros log
			INNER JOIN dne.dne_gu_bairros bai ON log.chave_bai_ini_dne = bai.chave_bai_dne
			INNER JOIN dne.dne_gu_localidades loc ON bai.chave_loc_dne = loc.chave_loc_dne
			INNER JOIN dne.dne_gu_unidades_federacao uf ON uf.sigla_uf = log.sigla_uf
		WHERE 
			upper(log.nome_ofi_logradouro) like '%'||upper(#rua:VARCHAR#)||'%'
	</select>
	
	<select id="getRegByRua" parameterClass="HashMap" resultClass="LogradouroVO">
		SELECT 
			log.nome_ofi_logradouro AS
			logradouro,log.tipo_ofi_logradouro,loc.nome_ofi_localidade AS cidade,
			log.sigla_uf AS uf, uf.nome_oficial_uf, bai.nome_ofi_bai AS bairro,
			loc.nome_ofi_localidade,log.cep_logradouro AS cep,log.sigla_uf
		FROM 
			dne.dne_gu_logradouros log
			INNER JOIN dne.dne_gu_bairros bai ON log.chave_bai_ini_dne = bai.chave_bai_dne
			INNER JOIN dne.dne_gu_localidades loc ON bai.chave_loc_dne = loc.chave_loc_dne
			INNER JOIN dne.dne_gu_unidades_federacao uf ON uf.sigla_uf = log.sigla_uf
		WHERE 
			upper(log.nome_ofi_logradouro) like '%'||upper(#rua:VARCHAR#)||'%'
	</select>
	
	<select id="getRegByCEPLoc" parameterClass="String" resultClass="LogradouroVO">
		SELECT 
			loc.nome_ofi_localidade AS cidade, loc.cep_localidade AS cep, bai.nome_ofi_bai AS bairro
		FROM 
			dne.dne_gu_localidades loc
	        INNER JOIN dne.dne_gu_bairros bai ON bai.chave_loc_dne = loc.chave_loc_dne 
        WHERE 
        	loc.cep_localidade = #value:VARCHAR#
	</select>

</sqlMap>
