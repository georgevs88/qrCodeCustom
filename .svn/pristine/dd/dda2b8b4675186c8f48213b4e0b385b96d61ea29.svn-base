<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Cfa">
	<typeAlias alias="CfaVO" type="pmcg.fcn.domain.CfaVO" />


	<resultMap id="mapComplexQuerySimple" class="CfaVO">
		<result property="iddcfa" column="iddcfa" />
		<result property="colcfa" column="colcfa" />
		<result property="codcfa" column="codcfa" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="CfaVO">
		<result property="iddcfa" column="iddcfa" />
		<result property="colcfa" column="colcfa" />
		<result property="codcfa" column="codcfa" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncfa WHERE iddcfa = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcncfa WHERE iddcfa = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="CfaVO"
		resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncfa
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcfa" prepend=" AND ">
				iddcfa = #iddcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="colcfa" prepend=" AND ">
				colcfa = #colcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="codcfa" prepend=" AND ">
				codcfa ILIKE '%' || #codcfa:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="CfaVO"
		resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcncfa
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcfa" prepend=" AND "> iddcfa =
				#iddcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="colcfa" prepend=" AND "> colcfa =
				#colcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="codcfa" prepend=" AND ">
				codcfa ILIKE '%' || #codcfa:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcncfa
	</select>

	<insert id="insReg" parameterClass="CfaVO">
		<selectKey keyProperty="iddcfa" resultClass="Long">
			SELECT NEXTVAL('fcn.seqcfa')
		</selectKey>
		INSERT INTO fcn.fcncfa(iddcfa,colcfa,codcfa) VALUES
		(#iddcfa:NUMERIC#,#colcfa:NUMERIC#, UPPER(#codcfa:VARCHAR#) )
	</insert>

	<update id="updRegByCod" parameterClass="CfaVO">
		UPDATE fcn.fcncfa SET colcfa= #colcfa:NUMERIC#,codcfa= UPPER(#codcfa:VARCHAR#)
		WHERE iddcfa = #iddcfa:NUMERIC#
	</update>
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM fcn.fcncfa WHERE iddcfa = #value:NUMERIC#
	</delete>
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM fcn.fcncfa WHERE iddcfa in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="CfaVO"
		resultClass="Integer">
		SELECT count(iddcfa) FROM fcn.fcncfa
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddcfa" prepend=" AND "> iddcfa =
				#iddcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="colcfa" prepend=" AND "> colcfa =
				#colcfa:NUMERIC#
			</isNotNull>
			<isNotNull property="codcfa" prepend=" AND ">
				codcfa ILIKE '%' || #codcfa:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="getCfaByCol" parameterClass="Long" resultClass="CfaVO">
		SELECT * FROM fcn.fcncfa WHERE colcfa = #value:NUMERC#
	</select>
</sqlMap> 
 