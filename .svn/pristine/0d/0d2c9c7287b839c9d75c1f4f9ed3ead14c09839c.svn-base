package pmcg.imti.ui;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Properties;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class LogicUtils {

	public static void sendEmail(String cpfusu, String email, String senha, String nomeusu) {
		String host = "smtp.issdigital.capital.ms.gov.br";
		String port = "25";
		String to = email;
		String from = "'Prefeitura Municipal de Campo Grande-MS (Não-Responda)'<contador@issdigital.capital.ms.gov.br>";
		String subject = "Senha de acesso ao Sistema Nota Fiscal de Serviços Eletrônica - Avulsa";

		Properties props = System.getProperties();
		props.put("mail.host", host);
		props.put("mail.smtp.host", host);
		props.put("mail.smtp.port", port);
		props.put("mail.smtp.starttls.enable", "true");
		props.put("mail.smtp.auth", "true");
		props.put("mail.smtp.socketFactory.port", port);
		props.put("mail.transport.protocol", "smtp");
		props.put("mail.debug", "false");
		//System.out.println("ANTES SESSION ##########");
		javax.mail.Session session = javax.mail.Session.getInstance(
				props, new Autenticacao());
		//System.out.println("DEPOIS SESSION ##########");
		try {
			Message msg = new MimeMessage(session);

			msg.setFrom(new InternetAddress(from));
			InternetAddress[] address = { new InternetAddress(to),
					new InternetAddress(from) };
			msg.setRecipients(Message.RecipientType.TO, address);
			msg.setSubject(subject);
			msg.setSentDate(new Date(System.currentTimeMillis()));

			String body = "<div>"
						+ "  <div style=\"background:#f5f5f5;width:650px;margin:5px;border:1px solid #e5e5e5;padding-left:20px;padding:5px 20px 0 20px\">"
						+ "    <table style=\"margin:15px 0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "      <tbody>"
						+ "        <tr>"
						+ "          <td height=\"45\" width=\"99\"><a href=\"http://nfsa.capital.ms.gov.br\" style=\"text-decoration:none\" target=\"_blank\"><img src=\"http://www.pmcg.ms.gov.br/egov/portal/img/brasao-campo-grande.png\" alt=\"Prefeitura municipal de campo grande-ms\" border=\"0\" height=\"89\" width=\"88\"></a></td>"
						+ "          <td align=\"left\" height=\"45\" width=\"413\"><div>"
						+ "              <h1 style=\"color: #FF931E;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">Prefeitura Municipal</h1>"
						+ "              <p style=\"color: #FF931E;font-family: 'Open Sans',Arial,Helvetica,sans-serif; font-size:12px;font-style: italic;\">Campo Grande - MS</p>"
						+ "            </div></td>"
						+ "          <td width=\"14\" height=\"45\" align=\"left\"></td>"
						+ "          <td width=\"124\" height=\"45\" align=\"left\"><div>"
						+ "              <h2 style=\"color: #FF931E;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">SEMRE</h2>"
						+ "              <p style=\"color: #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif; font-size:12px;font-style: italic;\">Secretaria Municipal da Receita</p>"
						+ "            </div></td>"
						+ "        </tr>"
						+ "      </tbody>"
						+ "    </table>"
						+ "    <table style=\"color:#fff;margin-bottom:20px\" border=\"0\" cellpadding=\"0\" width=\"650\">"
						+ "      <tbody>"
						+ "        <tr>"
						+ "          <td><div style=\"border-color:#3079ed;background-color:#4d90fe;border:1px solid #2f5bb7;white-space:nowrap;min-height:29px;line-height:29px;text-align:left;padding:0;font-weight:bold; text-align:center; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">MENSAGEM NOTA FISCAL DE SERVIÇOS ELETRÔNICA - AVULSA</div></td>"
						+ "        </tr>"
						+ "      </tbody>"
						+ "    </table>"
						+ "    <table style=\"min-height:213px;border:1px solid #bbb;border-bottom:0;padding:0;background:#fff\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "      <tbody>"
						+ "        <tr>"
						+ "          <td style=\"padding:0 20px;margin:0\" height=\"200\" width=\"332\"><div style=\"margin-top:13px;color:#999;font-weight:bold;font-size:120%;line-height:20px\">Senhor (a) NOMEUSU, </div>"
						+ "            <div style=\"padding:4px 0;color:#333;font-size:80%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "              <p>Conforme sua solicitação, estamos lhe enviando sua senha de Acesso ao sistema Nota Fiscal de Serviços Eletrônica - Avulsa.</p>"
						+ "            </div></td>"
						+ "          <td style=\"padding:0;margin:0; text-align:center; vertical-align:top\" align=\"center\" height=\"215\" width=\"278\"><img src=\"http://nfse.pmcg.ms.gov.br/NotaFiscal/imagens/logo_nfse.png\" alt=\"\" height=\"148\" width=\"214\">"
						+ "            <p style=\"margin:13px 0\"><a href=\"http://nfsa.capital.ms.gov.br\" style=\"text-decoration:none;display:block;text-align:center;color:white;font-size:100%;font-weight:bold;padding:0 15px;white-space:nowrap;text-transform:uppercase;letter-spacing:1;background-color:#4d90fe;min-height:29px;line-height:29px;margin:0 0 0 0;border:1px solid #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\" target=\"_blank\">Acesse agora</a></p></td>"
						+ "        </tr>"
						+ "      </tbody>"
						+ "    </table>"
						+ "    <p style=\"margin:20px 0 0px 5px;min-height:25px;font-size:18px;color:#333;width:650px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">Dados de acesso:</p>"
						+ "    <table style=\"margin:0 0 20px 0;background:#fff;border:1px solid #e5e5e5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "      <tbody>"
						+ "        <tr>"
						+ "          <td style=\"padding:20px 10px 10px 20px\" valign=\"top\" width=\"420\"><div style=\"color:#333;font-weight:bold;line-height:21px;margin:0px\"> Login: CPFUSU </div></td><br />"
						+ "       </tr>"
						+ "        <tr>"
						+ "         <td style=\"padding:10px 10px 20px 20px\" valign=\"top\" width=\"420\"><div style=\"color:#333;font-weight:bold;line-height:21px;margin:0px\"> Senha: PASSWD </div></td>"
						+ "        </tr>"
						+ "      </tbody>"
						+ "    </table>"
						+ "    <div style=\"padding:4px 0;color:#333;font-size:75%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "              <p>MAIORES INFORMAÇÕES:<br />"
						+ "              Plantão Fiscal: Rua Candido Mariano, 2655 - Centro<br />"
						+ "              Campo Grande - MS<br />"
						+ "              http://nfsa.capital.ms.gov.br<br />"
						+ "              notafiscal@semre.capital.ms.gov.br</p>"
						+ "            </div>"
						+ "    <table style=\"padding:0;margin:0 0 20px 0px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"652\">"
						+ "      <tbody>"
						+ "        <tr>"
						+ "          <td style=\"text-align:left;vertical-align:middle; padding-left:20px;\" width=\"652\"><img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-brasao-semre.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\" /> <img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-imti.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\"></td>"
						+ "        </tr>"
						+ "      </tbody>"
						+ "    </table>"
						+ "  </div>"
						+ "  <table width=\"700\">"
						+ "    <tbody>"
						+ "      <tr>"
						+ "        <td colspan=\"2\" style=\"font-size:11px;color:#999;text-align:center;padding:20px 0; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">&copy;ANOATUAL SEMRE - Secretaria Municipal de Receita <br />"
						+ "          Rua Mal Rondon, 2655 - Centro &middot; CEP: 79002-943 &middot; Campo Grande MS &middot; notafiscal@semre.capital.ms.gov.br <br></td>"
						+ "      </tr>"
						+ "    </tbody>"
						+ "  </table>"
						+ "  <img src=\"https://www.google.com/offers/ga/db0a8a36771f7cd9/4UPO132AYO54BRVW/unpersonalized?r=-2073480139\" style=\"border:none\" alt=\"\" height=\"1\" width=\"1\"> <img src=\"https://googleads.g.doubleclick.net/pagead/viewthroughconversion/967763451/?label=hVjWCIWXnwMQ-8u7zQM&amp;guid=ON&amp;script=0&amp;data=s%3Dep%3Bid%3D4UPO132AYO54BRVW%3Boffcat%3DOTHER_RETAIL\" alt=\"\" height=\"1\" width=\"1\"></div>";

			body = body.replaceAll("\n", "<br />");
			body = body.replaceAll("NOMEUSU", nomeusu);
			body = body.replaceAll("CPFUSU", cpfusu);
			body = body.replaceAll("PASSWD", senha);
			body = body.replaceAll("ANOATUAL", new SimpleDateFormat("yyyy").format(new Date()));

			msg.setContent(body, "text/html;charset=Cp1252;");
			
			Transport.send(msg);
		} catch (AddressException e) {
			e.printStackTrace();
		} catch (MessagingException mex) {
			mex.printStackTrace();
		}
	}
	
	public static void sendEmailCad(String cpfusu, String email, String senha, String nomeusu) {
		String host = "smtp.issdigital.capital.ms.gov.br";
		String port = "25";
		String to = email;
		String from = "'Prefeitura Municipal de Campo Grande-MS (Não-Responda)'<contador@issdigital.capital.ms.gov.br>";
		String subject = "Senha de acesso ao Sistema CIM";

		Properties props = System.getProperties();
		props.put("mail.host", host);
		props.put("mail.smtp.host", host);
		props.put("mail.smtp.port", port);
		props.put("mail.smtp.starttls.enable", "true");
		props.put("mail.smtp.auth", "true");
		props.put("mail.smtp.socketFactory.port", port);
		props.put("mail.transport.protocol", "smtp");
		props.put("mail.debug", "false");
		
		javax.mail.Session session = javax.mail.Session.getInstance(props, new Autenticacao());
		try {
			Message msg = new MimeMessage(session);
			msg.setFrom(new InternetAddress(from));
			InternetAddress[] address = { new InternetAddress(to),
					new InternetAddress(from) };
			msg.setRecipients(Message.RecipientType.TO, address);
			msg.setSubject(subject);
			msg.setSentDate(new Date(System.currentTimeMillis()));
			String body = "<div>"
						+ "	<div style=\"background:#f5f5f5;width:650px;margin:5px;border:1px solid #e5e5e5;padding-left:20px;padding:5px 20px 0 20px\">"
						+ "		<table style=\"margin:15px 0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td height=\"45\" width=\"99\">"
						+ "						<a href=\"http://www.capital.ms.gov.br\" style=\"text-decoration:none\" target=\"_blank\">"
						+ "							<img src=\"http://www.pmcg.ms.gov.br/egov/portal/img/brasao-campo-grande.png\" alt=\"Prefeitura municipal de campo grande-ms\" border=\"0\" height=\"89\" width=\"88\">"
						+ "						</a>"
						+ "					</td>"
						+ "					<td align=\"left\" height=\"45\" width=\"413\">"
						+ "						<div>"
						+ "							<h1 style=\"color: #666;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">Campo Grande - MS</h1>"
						+ "							<p style=\"font-size: 15px;display: block;color: #0078B7;font-style: italic;font-family: arial,sans-serif;\">Prefeitura Municipal - CIM</p>"
						+ "						</div>"
						+ "					</td>"
						+ "					<td width=\"14\" height=\"45\" align=\"left\"/>"
						+ "					<td width=\"124\" height=\"45\" align=\"left\">"
						+ "						<div>"
						+ "							<h2 style=\"color: #FF931E;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">SEMRE</h2>"
						+ "							<p style=\"color: #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif; font-size:12px;font-style: italic;\">Secretaria Municipal da Receita</p>"
						+ "						</div>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<table style=\"color:#fff;margin-bottom:20px\" border=\"0\" cellpadding=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td>"
						+ "						<div style=\"border-color:#3079ed;background-color:#005A89;border:1px solid #2f5bb7;white-space:nowrap;min-height:29px;line-height:29px;text-align:left;padding:0;font-weight:bold; text-align:center; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">Registro PMCG - Cadastro Integrado Municipal</div>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<table style=\"min-height:120px;border:1px solid #bbb;padding:0;background:#fff\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td style=\"padding:0 20px;margin:0\" height=\"100\" width=\"332\">"
						+ "						<div style=\"margin-top:13px;color:#999;font-weight:bold;font-size:120%;line-height:20px\">Senhor (a) NOMEUSU, </div>"
						+ "						<div style=\"padding:4px 0;color:#333;font-size:80%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "							<p>Conforme sua solicitação, estamos lhe enviando sua senha de Acesso ao Sistema PMCG - CIM.</p>"
						+ "						</div>"
						+ "					</td>"
						+ "					<td style=\"padding:0;margin:0; text-align:center; vertical-align:top\" align=\"center\" height=\"100\" width=\"278\">"
						+ "						<p style=\"margin:0px 0\">"
						+ "							<a href=\"http://cim.campogrande.ms.gov.br/\" style=\"text-decoration:none;display:block;text-align:center;color:white;font-size:100%;font-weight:bold;padding:0 15px;white-space:nowrap;text-transform:uppercase;letter-spacing:1;background-color:#005A89;min-height:29px;line-height:29px;margin:35 0 0 0;border:1px solid #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\" target=\"_blank\">Acesse agora</a>"
						+ "						</p>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<table style=\"margin:0 0 10px 0;background:#fff;border:1px solid #e5e5e5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td style=\"padding:20px 10px 10px 20px\" valign=\"top\" width=\"420\">"
						+ "						<div style=\"color:#333;font-weight:bold;line-height:21px;margin:0px\"> Login: CPFUSU </div>"
						+ "					</td>"
						+ "					<br />"
						+ "				</tr>"
						+ "				<tr>"
						+ "					<td style=\"padding:10px 10px 20px 20px\" valign=\"top\" width=\"420\">"
						+ "						<div style=\"color:#333;font-weight:bold;line-height:21px;margin:0px\"> Senha: PASSWD </div>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<div style=\"padding:4px 0;color:#333;font-size:75%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "			<p>MAIORES INFORMAÇÕES:<br />"
						+ "				Plantão Fiscal: Rua Candido Mariano, 2655 - Centro<br />"
						+ "				Campo Grande - MS<br />"
						+ "				http://cim.campogrande.ms.gov.br/"
						+ "			</p>"
						+ "		</div>"
						+ "		<table style=\"padding:0;margin:0 0 20px 0px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"652\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td style=\"text-align:left;vertical-align:middle; padding-left:20px;\" width=\"652\">"
						+ "						<img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-brasao-semre.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\" />"
						+ "						<img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-imti.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\">"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "	</div>"
						+ "	<table width=\"700\">"
						+ "		<tbody>"
						+ "			<tr>"
						+ "				<td colspan=\"2\" style=\"font-size:11px;color:#999;text-align:center;padding:20px 0; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">&copy;ANOATUAL SEMRE - Secretaria Municipal de Receita <br />"
						+ "					Rua Mal Rondon, 2655 - Centro &middot; CEP: 79002-943 &middot; Campo Grande MS &middot; semre@semre.capital.ms.gov.br <br>"
						+ "				</td>"
						+ "			</tr>"
						+ "		</tbody>"
						+ "	</table>"
						+ "	<img src=\"https://www.google.com/offers/ga/db0a8a36771f7cd9/4UPO132AYO54BRVW/unpersonalized?r=-2073480139\" style=\"border:none\" alt=\"\" height=\"1\" width=\"1\">"
						+ "	<img src=\"https://googleads.g.doubleclick.net/pagead/viewthroughconversion/967763451/?label=hVjWCIWXnwMQ-8u7zQM&amp;guid=ON&amp;script=0&amp;data=s%3Dep%3Bid%3D4UPO132AYO54BRVW%3Boffcat%3DOTHER_RETAIL\" alt=\"\" height=\"1\" width=\"1\">"
						+ "</div>";

			body = body.replaceAll("\n", "<br />");
			body = body.replaceAll("NOMEUSU", nomeusu);
			body = body.replaceAll("CPFUSU", cpfusu);
			body = body.replaceAll("PASSWD", senha);
			body = body.replaceAll("ANOATUAL", new SimpleDateFormat("yyyy").format(new Date()));

			msg.setContent(body, "text/html;charset=Cp1252;");
			Transport.send(msg);
		} catch (AddressException e) {
			e.printStackTrace();
		} catch (MessagingException mex) {
			mex.printStackTrace();
		}
	}
	
	public static void sendEmailInsmun(String email, String protocolo, String cpfcnpj, String nomraz, String insmun) {
		String host = "smtp.issdigital.capital.ms.gov.br";
		String port = "25";
		String to = email;
		String from = "'Prefeitura Municipal de Campo Grande-MS (Não-Responda)'<contador@issdigital.capital.ms.gov.br>";
		String subject = "Sistema CIM - Registro de Inscrição Municipal";

		Properties props = System.getProperties();
		props.put("mail.host", host);
		props.put("mail.smtp.host", host);
		props.put("mail.smtp.port", port);
		props.put("mail.smtp.starttls.enable", "true");
		props.put("mail.smtp.auth", "true");
		props.put("mail.smtp.socketFactory.port", port);
		props.put("mail.transport.protocol", "smtp");
		props.put("mail.debug", "false");
		
		javax.mail.Session session = javax.mail.Session.getInstance(props, new Autenticacao());
		try {
			Message msg = new MimeMessage(session);
			msg.setFrom(new InternetAddress(from));
			InternetAddress[] address = { new InternetAddress(to),
					new InternetAddress(from) };
			msg.setRecipients(Message.RecipientType.TO, address);
			msg.setSubject(subject);
			msg.setSentDate(new Date(System.currentTimeMillis()));
			String body = "<div>"
						+ "	<div style=\"background:#f5f5f5;width:650px;margin:5px;border:1px solid #e5e5e5;padding-left:20px;padding:5px 20px 0 20px\">"
						+ "		<table style=\"margin:15px 0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td height=\"45\" width=\"99\">"
						+ "						<a href=\"http://www.capital.ms.gov.br\" style=\"text-decoration:none\" target=\"_blank\">"
						+ "							<img src=\"http://www.pmcg.ms.gov.br/egov/portal/img/brasao-campo-grande.png\" alt=\"Prefeitura municipal de campo grande-ms\" border=\"0\" height=\"89\" width=\"88\">"
						+ "						</a>"
						+ "					</td>"
						+ "					<td align=\"left\" height=\"45\" width=\"413\">"
						+ "						<div>"
						+ "							<h1 style=\"color: #666;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">Campo Grande - MS</h1>"
						+ "							<p style=\"font-size: 15px;display: block;color: #0078B7;font-style: italic;font-family: arial,sans-serif;\">Prefeitura Municipal - CIM</p>"
						+ "						</div>"
						+ "					</td>"
						+ "					<td width=\"14\" height=\"45\" align=\"left\"/>"
						+ "					<td width=\"124\" height=\"45\" align=\"left\">"
						+ "						<div>"
						+ "							<h2 style=\"color: #FF931E;font-family: 'Open Sans',Arial,Helvetica,sans-serif; margin:0;\">SEMRE</h2>"
						+ "							<p style=\"color: #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif; font-size:12px;font-style: italic;\">Secretaria Municipal da Receita</p>"
						+ "						</div>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<table style=\"color:#fff;margin-bottom:20px\" border=\"0\" cellpadding=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td>"
						+ "						<div style=\"border-color:#3079ed;background-color:#005A89;border:1px solid #2f5bb7;white-space:nowrap;min-height:29px;line-height:29px;text-align:left;padding:0;font-weight:bold; text-align:center; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">Registro PMCG - CIM</div>"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<table style=\"min-height:120px;border:1px solid #bbb;padding:0;background:#fff\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"650\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td style=\"padding:0 20px;margin:0\" height=\"100\" width=\"332\">"
						+ "						<div style=\"margin-top:13px;color:#999;font-weight:bold;font-size:120%;line-height:20px\">Informamos que foi gerada a seguinte Inscrição Municipal:</div>"
						+ "						<div style=\"padding:4px 0;color:#333;font-size:80%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "							<p>Protocolo: NPREPD</p>"
						+ "							<p>CPF/CNPJ: CPFCNPJ</p>"
						+ "							<p>Nome/Razão Social: NOMRAZ</p>"
						+ "							<p style=\"color:RED;font-weight:bold;font-size:16px;\">INSCRIÇÃO MUNICIPAL: INSMUN</p>"
						+ "						</div>"
						+ "					</td>"
						+ "					<!--<td style=\"padding:0;margin:0; text-align:center; vertical-align:top\" align=\"center\" height=\"100\" width=\"278\">"
						+ "						<p style=\"margin:0px 0\">"
						+ "							<a href=\"http://cim.campogrande.ms.gov.br/\" style=\"text-decoration:none;display:block;text-align:center;color:white;font-size:100%;font-weight:bold;padding:0 15px;white-space:nowrap;text-transform:uppercase;letter-spacing:1;background-color:#005A89;min-height:29px;line-height:29px;margin:35 0 0 0;border:1px solid #2572AB;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\" target=\"_blank\">Acesse agora</a>"
						+ "						</p>"
						+ "					</td>-->"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "		<div style=\"padding:4px 0;color:#333;font-size:75%;line-height:20px;font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">"
						+ "			<p>MAIORES INFORMAÇÕES:<br />"
						+ "				Plantão Fiscal: Rua Candido Mariano, 2655 - Centro<br />"
						+ "				Campo Grande - MS<br />"
						+ "				http://cim.campogrande.ms.gov.br/"
						+ "			</p>"
						+ "		</div>"
						+ "		<table style=\"padding:0;margin:0 0 20px 0px\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"652\">"
						+ "			<tbody>"
						+ "				<tr>"
						+ "					<td style=\"text-align:left;vertical-align:middle; padding-left:20px;\" width=\"652\">"
//						+ "						<img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-brasao-semre.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\" />"
						+ "						<img alt=\"\" src=\"http://www.capital.ms.gov.br/egov/semre/contadores/logo-imti.png\" style=\"padding:0 10px 0 0\" border=\"0\" height=\"46\">"
						+ "					</td>"
						+ "				</tr>"
						+ "			</tbody>"
						+ "		</table>"
						+ "	</div>"
						+ "	<table width=\"700\">"
						+ "		<tbody>"
						+ "			<tr>"
						+ "				<td colspan=\"2\" style=\"font-size:11px;color:#999;text-align:center;padding:20px 0; font-family: 'Open Sans',Arial,Helvetica,sans-serif;\">&copy;ANOATUAL SEFIN - Secretaria Municipal de Finanças e Planejamento <br />"
						+ "					Rua Mal Rondon, 2655 - Centro &middot; CEP: 79002-943 &middot; Campo Grande MS &middot; semre@semre.capital.ms.gov.br <br>"
						+ "				</td>"
						+ "			</tr>"
						+ "		</tbody>"
						+ "	</table>"
						+ "	<img src=\"https://www.google.com/offers/ga/db0a8a36771f7cd9/4UPO132AYO54BRVW/unpersonalized?r=-2073480139\" style=\"border:none\" alt=\"\" height=\"1\" width=\"1\">"
						+ "	<img src=\"https://googleads.g.doubleclick.net/pagead/viewthroughconversion/967763451/?label=hVjWCIWXnwMQ-8u7zQM&amp;guid=ON&amp;script=0&amp;data=s%3Dep%3Bid%3D4UPO132AYO54BRVW%3Boffcat%3DOTHER_RETAIL\" alt=\"\" height=\"1\" width=\"1\">"
						+ "</div>";

			body = body.replaceAll("\n", "<br />");
			body = body.replaceAll("NPREPD", protocolo);
			body = body.replaceAll("CPFCNPJ", cpfcnpj);
			body = body.replaceAll("NOMRAZ", nomraz);
			body = body.replaceAll("INSMUN", insmun);
			body = body.replaceAll("ANOATUAL", new SimpleDateFormat("yyyy").format(new Date()));

			msg.setContent(body, "text/html;charset=Cp1252;");
			Transport.send(msg);
		} catch (AddressException e) {
			e.printStackTrace();
		} catch (MessagingException mex) {
			mex.printStackTrace();
		}
	}

}
