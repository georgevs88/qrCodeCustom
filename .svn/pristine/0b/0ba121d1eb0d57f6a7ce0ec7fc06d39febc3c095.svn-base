<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Soc">
	<typeAlias alias="SocVO" type="pmcg.fcn.domain.SocVO" />


	<resultMap id="mapComplexQuerySimple" class="SocVO">
		<result property="iddsoc" column="iddsoc" />
		<result property="consoc" column="consoc" />
		<result property="dinsoc" column="dinsoc" />
		<result property="dfisoc" column="dfisoc" />
		<result property="parsoc" column="parsoc" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="SocVO">
		<result property="iddsoc" column="iddsoc" />
		<result property="consoc" column="consoc" />
		<result property="dinsoc" column="dinsoc" />
		<result property="dfisoc" column="dfisoc" />
		<result property="parsoc" column="parsoc" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsoc WHERE iddsoc = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcnsoc WHERE iddsoc = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="SocVO"
		resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsoc
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsoc" prepend=" AND ">
				iddsoc = #iddsoc:NUMERIC#
			</isNotNull>
			<isNotNull property="consoc" prepend=" AND ">
				consoc = #consoc:NUMERIC#
			</isNotNull>
			<isNotNull property="dinsoc" prepend=" AND ">
				to_char(dinsoc,'dd/MM/yyyy') =
				to_char(#dinsoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfisoc" prepend=" AND ">
				to_char(dfisoc,'dd/MM/yyyy') =
				to_char(#dfisoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="parsoc" prepend=" AND ">
				parsoc ILIKE '%' || #parsoc:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="SocVO"
		resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcnsoc
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsoc" prepend=" AND "> iddsoc =
				#iddsoc:NUMERIC#
			</isNotNull>
			<isNotNull property="consoc" prepend=" AND "> consoc =
				#consoc:NUMERIC#
			</isNotNull>
			<isNotNull property="dinsoc" prepend=" AND ">
				to_char(dinsoc,'dd/MM/yyyy') =
				to_char(#dinsoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfisoc" prepend=" AND ">
				to_char(dfisoc,'dd/MM/yyyy') =
				to_char(#dfisoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="parsoc" prepend=" AND ">
				parsoc ILIKE '%' || #parsoc:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsoc
	</select>

	<insert id="insReg" parameterClass="SocVO">
		<selectKey keyProperty="iddsoc" resultClass="Long">
			SELECT NEXTVAL('fcn.seqsoc')
		</selectKey>
		INSERT INTO fcn.fcnsoc(iddsoc,consoc,dinsoc,dfisoc,parsoc) VALUES
		(#iddsoc:NUMERIC#,#consoc:NUMERIC#,#dinsoc:TIMESTAMP#,#dfisoc:TIMESTAMP#,
		UPPER(#parsoc:VARCHAR#) )
	</insert>

	<update id="updRegByCod" parameterClass="SocVO">
		UPDATE fcn.fcnsoc SET consoc= #consoc:NUMERIC#,dinsoc=
		#dinsoc:TIMESTAMP#,dfisoc= #dfisoc:TIMESTAMP#,parsoc=
		UPPER(#parsoc:VARCHAR#) WHERE iddsoc = #iddsoc:NUMERIC#
	</update>
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM fcn.fcnsoc WHERE iddsoc = #value:NUMERIC#
	</delete>
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM fcn.fcnsoc WHERE iddsoc in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="SocVO"
		resultClass="Integer">
		SELECT count(iddsoc) FROM fcn.fcnsoc
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsoc" prepend=" AND "> iddsoc =
				#iddsoc:NUMERIC#
			</isNotNull>
			<isNotNull property="consoc" prepend=" AND "> consoc =
				#consoc:NUMERIC#
			</isNotNull>
			<isNotNull property="dinsoc" prepend=" AND ">
				to_char(dinsoc,'dd/MM/yyyy') =
				to_char(#dinsoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfisoc" prepend=" AND ">
				to_char(dfisoc,'dd/MM/yyyy') =
				to_char(#dfisoc:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="parsoc" prepend=" AND ">
				parsoc ILIKE '%' || #parsoc:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>
</sqlMap> 
 