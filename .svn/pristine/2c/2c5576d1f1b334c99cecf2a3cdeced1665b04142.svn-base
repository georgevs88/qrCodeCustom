<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Taf">
	<typeAlias alias="TafVO" type="pmcg.fcn.domain.TafVO" />


	<resultMap id="mapComplexQuerySimple" class="TafVO">
		<result property="iddtaf" column="iddtaf" />
		<result property="tabtaf" column="tabtaf" />
		<result property="inftaf" column="inftaf" />
		<result property="at1taf" column="at1taf" />
		<result property="at2taf" column="at2taf" />
		<result property="at3taf" column="at3taf" />
		<result property="at4taf" column="at4taf" />
		<result property="at5taf" column="at5taf" />
		<result property="dattaf" column="dattaf" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="TafVO">
		<result property="iddtaf" column="iddtaf" />
		<result property="tabtaf" column="tabtaf" />
		<result property="inftaf" column="inftaf" />
		<result property="at1taf" column="at1taf" />
		<result property="at2taf" column="at2taf" />
		<result property="at3taf" column="at3taf" />
		<result property="at4taf" column="at4taf" />
		<result property="at5taf" column="at5taf" />
		<result property="dattaf" column="dattaf" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcntaf WHERE iddtaf = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcntaf WHERE iddtaf = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="TafVO"
		resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcntaf
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddtaf" prepend=" AND ">
				iddtaf = #iddtaf:NUMERIC#
			</isNotNull>
			<isNotNull property="tabtaf" prepend=" AND ">
				tabtaf ILIKE '%' || #tabtaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="inftaf" prepend=" AND ">
				inftaf ILIKE '%' || #inftaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at1taf" prepend=" AND ">
				at1taf ILIKE '%' || #at1taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at2taf" prepend=" AND ">
				at2taf ILIKE '%' || #at2taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at3taf" prepend=" AND ">
				at3taf ILIKE '%' || #at3taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at4taf" prepend=" AND ">
				at4taf = #at4taf:NUMERIC#
			</isNotNull>
			<isNotNull property="at5taf" prepend=" AND ">
				at5taf = #at5taf:NUMERIC#
			</isNotNull>
			<isNotNull property="dattaf" prepend=" AND ">
				to_char(dattaf,'dd/MM/yyyy') =
				to_char(#dattaf:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="TafVO"
		resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcntaf
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddtaf" prepend=" AND "> iddtaf =
				#iddtaf:NUMERIC#
			</isNotNull>
			<isNotNull property="tabtaf" prepend=" AND ">
				tabtaf ILIKE '%' || #tabtaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="inftaf" prepend=" AND ">
				inftaf ILIKE '%' || #inftaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at1taf" prepend=" AND ">
				at1taf ILIKE '%' || #at1taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at2taf" prepend=" AND ">
				at2taf ILIKE '%' || #at2taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at3taf" prepend=" AND ">
				at3taf ILIKE '%' || #at3taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at4taf" prepend=" AND "> at4taf =
				#at4taf:NUMERIC#
			</isNotNull>
			<isNotNull property="at5taf" prepend=" AND "> at5taf =
				#at5taf:NUMERIC#
			</isNotNull>
			<isNotNull property="dattaf" prepend=" AND ">
				to_char(dattaf,'dd/MM/yyyy') =
				to_char(#dattaf:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcntaf
	</select>

	<insert id="insReg" parameterClass="TafVO">
		<selectKey keyProperty="iddtaf" resultClass="Long">
			SELECT NEXTVAL('fcn.seqtaf')
		</selectKey>
		INSERT INTO
		fcn.fcntaf(iddtaf,tabtaf,inftaf,at1taf,at2taf,at3taf,at4taf,at5taf,dattaf)
		VALUES (#iddtaf:NUMERIC#, UPPER(#tabtaf:VARCHAR#),
		UPPER(#inftaf:VARCHAR#), UPPER(#at1taf:VARCHAR#),
		UPPER(#at2taf:VARCHAR#),
		UPPER(#at3taf:VARCHAR#),#at4taf:NUMERIC#,#at5taf:NUMERIC#,#dattaf:TIMESTAMP#
		)
	</insert>

	<update id="updRegByCod" parameterClass="TafVO">
		UPDATE fcn.fcntaf SET tabtaf= UPPER(#tabtaf:VARCHAR#),inftaf=
		UPPER(#inftaf:VARCHAR#),at1taf= UPPER(#at1taf:VARCHAR#),at2taf=
		UPPER(#at2taf:VARCHAR#),at3taf= UPPER(#at3taf:VARCHAR#),at4taf=
		#at4taf:NUMERIC#,at5taf= #at5taf:NUMERIC#,dattaf= #dattaf:TIMESTAMP#
		WHERE iddtaf = #iddtaf:NUMERIC#
	</update>
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM fcn.fcntaf WHERE iddtaf = #value:NUMERIC#
	</delete>
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM fcn.fcntaf WHERE iddtaf in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="TafVO"
		resultClass="Integer">
		SELECT count(iddtaf) FROM fcn.fcntaf
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddtaf" prepend=" AND "> iddtaf =
				#iddtaf:NUMERIC#
			</isNotNull>
			<isNotNull property="tabtaf" prepend=" AND ">
				tabtaf ILIKE '%' || #tabtaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="inftaf" prepend=" AND ">
				inftaf ILIKE '%' || #inftaf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at1taf" prepend=" AND ">
				at1taf ILIKE '%' || #at1taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at2taf" prepend=" AND ">
				at2taf ILIKE '%' || #at2taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at3taf" prepend=" AND ">
				at3taf ILIKE '%' || #at3taf:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="at4taf" prepend=" AND "> at4taf =
				#at4taf:NUMERIC#
			</isNotNull>
			<isNotNull property="at5taf" prepend=" AND "> at5taf =
				#at5taf:NUMERIC#
			</isNotNull>
			<isNotNull property="dattaf" prepend=" AND ">
				to_char(dattaf,'dd/MM/yyyy') =
				to_char(#dattaf:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>
</sqlMap> 
 