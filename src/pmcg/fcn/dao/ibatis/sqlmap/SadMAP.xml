<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Sad">
	<typeAlias alias="SadVO" type="pmcg.fcn.domain.SadVO" />

	<resultMap id="mapComplexQuerySimple" class="SadVO">
		<result property="iddsad" column="iddsad" />
		<result property="nomsad" column="nomsad" />
		<result property="tipsad" column="tipsad" />
		<result property="cpfsad" column="cpfsad" />
		<result property="estsad" column="estsad" />
		<result property="nacsad" column="nacsad" />
		<result property="sexsad" column="sexsad" />
		<result property="dnasad" column="dnasad" />
		<result property="regsad" column="regsad" />
		<result property="emcsad" column="emcsad" />
		<result property="idesad" column="idesad" />
		<result property="oemsad" column="oemsad" />
		<result property="ufosad" column="ufosad" />
		<result property="npasad" column="npasad" />
		<result property="nmasad" column="nmasad" />
		<result property="prosad" column="prosad" />
		<result property="endsad" column="endsad" />
		<result property="emasad" column="emasad" />
		<result property="nirsad" column="nirsad" />
		<result property="cnpsad" column="cnpsad" />
		<result property="ncasad" column="ncasad" />
		<result property="socsad" column="socsad" />
		<result property="admsad" column="admsad" />
		<result property="adesad" column="adesad" />
		<result property="dddsad" column="dddsad" />
		<result property="telsad" column="telsad" />
		<result property="matsad" column="matsad" />
		<result property="tdcsad" column="tdcsad" />
		<result property="baesad" column="baesad" />
		<result property="qsisad" column="qsisad" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="SadVO">
		<result property="iddsad" column="iddsad" />
		<result property="nomsad" column="nomsad" />
		<result property="tipsad" column="tipsad" />
		<result property="cpfsad" column="cpfsad" />
		<result property="estsad" column="estsad" />
		<result property="nacsad" column="nacsad" />
		<result property="sexsad" column="sexsad" />
		<result property="dnasad" column="dnasad" />
		<result property="regsad" column="regsad" />
		<result property="emcsad" column="emcsad" />
		<result property="idesad" column="idesad" />
		<result property="oemsad" column="oemsad" />
		<result property="ufosad" column="ufosad" />
		<result property="npasad" column="npasad" />
		<result property="nmasad" column="nmasad" />
		<result property="prosad" column="prosad" />
		<result property="endsad" column="endsad" />
		<result property="emasad" column="emasad" />
		<result property="nirsad" column="nirsad" />
		<result property="cnpsad" column="cnpsad" />
		<result property="ncasad" column="ncasad" />
		<result property="socsad" column="socsad" />
		<result property="admsad" column="admsad" />
		<result property="adesad" column="adesad" />
		<result property="dddsad" column="dddsad" />
		<result property="telsad" column="telsad" />
		<result property="matsad" column="matsad" />
		<result property="tdcsad" column="tdcsad" />
		<result property="baesad" column="baesad" />
		<result property="qsisad" column="qsisad" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsad WHERE iddsad = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcnsad WHERE iddsad = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="SadVO" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsad
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsad" prepend=" AND ">
				iddsad = #iddsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nomsad" prepend=" AND ">
				nomsad ILIKE '%' || #nomsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tipsad" prepend=" AND ">
				tipsad ILIKE '%' || #tipsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfsad" prepend=" AND ">
				cpfsad ILIKE '%' || #cpfsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="estsad" prepend=" AND ">
				estsad = #estsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nacsad" prepend=" AND ">
				nacsad = #nacsad:NUMERIC#
			</isNotNull>
			<isNotNull property="sexsad" prepend=" AND ">
				sexsad ILIKE '%' || #sexsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnasad" prepend=" AND ">
				to_char(dnasad,'dd/MM/yyyy') =
				to_char(#dnasad:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="regsad" prepend=" AND ">
				regsad = #regsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emcsad" prepend=" AND ">
				emcsad = #emcsad:NUMERIC#
			</isNotNull>
			<isNotNull property="idesad" prepend=" AND ">
				idesad ILIKE '%' || #idesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="oemsad" prepend=" AND ">
				oemsad ILIKE '%' || #oemsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ufosad" prepend=" AND ">
				ufosad ILIKE '%' || #ufosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="npasad" prepend=" AND ">
				npasad ILIKE '%' || #npasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nmasad" prepend=" AND ">
				nmasad ILIKE '%' || #nmasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="prosad" prepend=" AND ">
				prosad ILIKE '%' || #prosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="endsad" prepend=" AND ">
				endsad = #endsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emasad" prepend=" AND ">
				emasad ILIKE '%' || #emasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nirsad" prepend=" AND ">
				nirsad ILIKE '%' || #nirsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cnpsad" prepend=" AND ">
				cnpsad ILIKE '%' || #cnpsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ncasad" prepend=" AND ">
				ncasad ILIKE '%' || #ncasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="socsad" prepend=" AND ">
				socsad = #socsad:NUMERIC#
			</isNotNull>
			<isNotNull property="admsad" prepend=" AND ">
				admsad = #admsad:NUMERIC#
			</isNotNull>
			<isNotNull property="adesad" prepend=" AND ">
				adesad ILIKE '%' || #adesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dddsad" prepend=" AND ">
				dddsad ILIKE '%' || #dddsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="telsad" prepend=" AND ">
				telsad ILIKE '%' || #telsad:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="SadVO"
		resultMap="mapComplexQuery">
		SELECT * FROM fcn.fcnsad
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsad" prepend=" AND "> iddsad =
				#iddsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nomsad" prepend=" AND ">
				nomsad ILIKE '%' || #nomsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tipsad" prepend=" AND ">
				tipsad ILIKE '%' || #tipsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfsad" prepend=" AND ">
				cpfsad ILIKE '%' || #cpfsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="estsad" prepend=" AND "> estsad =
				#estsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nacsad" prepend=" AND "> nacsad =
				#nacsad:NUMERIC#
			</isNotNull>
			<isNotNull property="sexsad" prepend=" AND ">
				sexsad ILIKE '%' || #sexsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnasad" prepend=" AND ">
				to_char(dnasad,'dd/MM/yyyy') =
				to_char(#dnasad:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="regsad" prepend=" AND "> regsad =
				#regsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emcsad" prepend=" AND "> emcsad =
				#emcsad:NUMERIC#
			</isNotNull>
			<isNotNull property="idesad" prepend=" AND ">
				idesad ILIKE '%' || #idesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="oemsad" prepend=" AND ">
				oemsad ILIKE '%' || #oemsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ufosad" prepend=" AND ">
				ufosad ILIKE '%' || #ufosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="npasad" prepend=" AND ">
				npasad ILIKE '%' || #npasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nmasad" prepend=" AND ">
				nmasad ILIKE '%' || #nmasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="prosad" prepend=" AND ">
				prosad ILIKE '%' || #prosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="endsad" prepend=" AND "> endsad =
				#endsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emasad" prepend=" AND ">
				emasad ILIKE '%' || #emasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nirsad" prepend=" AND ">
				nirsad ILIKE '%' || #nirsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cnpsad" prepend=" AND ">
				cnpsad ILIKE '%' || #cnpsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ncasad" prepend=" AND ">
				ncasad ILIKE '%' || #ncasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="socsad" prepend=" AND "> socsad =
				#socsad:NUMERIC#
			</isNotNull>
			<isNotNull property="admsad" prepend=" AND "> admsad =
				#admsad:NUMERIC#
			</isNotNull>
			<isNotNull property="adesad" prepend=" AND ">
				adesad ILIKE '%' || #adesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dddsad" prepend=" AND ">
				dddsad ILIKE '%' || #dddsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="telsad" prepend=" AND ">
				telsad ILIKE '%' || #telsad:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM fcn.fcnsad
	</select>

	<insert id="insReg" parameterClass="SadVO">
		<selectKey keyProperty="iddsad" resultClass="Long">
			SELECT NEXTVAL('fcn.seqsad')
		</selectKey>
		INSERT INTO
		fcn.fcnsad(iddsad,nomsad,tipsad,cpfsad,estsad,nacsad,sexsad,dnasad,regsad,emcsad,idesad,oemsad,ufosad,npasad,nmasad,prosad,endsad,emasad,nirsad,cnpsad,ncasad,socsad,admsad,adesad,dddsad,telsad,matsad,tdcsad,baesad,qsisad)
		VALUES (#iddsad:NUMERIC#, UPPER(#nomsad:VARCHAR#),
		UPPER(#tipsad:VARCHAR#),
		UPPER(#cpfsad:VARCHAR#),#estsad:NUMERIC#,#nacsad:NUMERIC#,
		UPPER(#sexsad:VARCHAR#),#dnasad:TIMESTAMP#,#regsad:NUMERIC#,#emcsad:NUMERIC#,
		UPPER(#idesad:VARCHAR#), UPPER(#oemsad:VARCHAR#),
		UPPER(#ufosad:VARCHAR#), UPPER(#npasad:VARCHAR#),
		UPPER(#nmasad:VARCHAR#), UPPER(#prosad:VARCHAR#),#endsad:NUMERIC#,
		#emasad:VARCHAR#, UPPER(#nirsad:VARCHAR#),
		UPPER(#cnpsad:VARCHAR#),
		UPPER(#ncasad:VARCHAR#),#socsad:NUMERIC#,#admsad:NUMERIC#,
		UPPER(#adesad:VARCHAR#), UPPER(#dddsad:VARCHAR#),
		UPPER(#telsad:VARCHAR#),#matsad:NUMERIC#, #tdcsad:VARCHAR#,#baesad:NUMERIC#, #qsisad:VARCHAR# )
	</insert>

	<update id="updRegByCod" parameterClass="SadVO">
		UPDATE fcn.fcnsad SET 
		nomsad= UPPER(#nomsad:VARCHAR#),
		tipsad= UPPER(#tipsad:VARCHAR#),
		cpfsad= UPPER(#cpfsad:VARCHAR#),
		estsad= #estsad:NUMERIC#,
		nacsad= #nacsad:NUMERIC#,
		sexsad= UPPER(#sexsad:VARCHAR#),
		dnasad= #dnasad:TIMESTAMP#,
		regsad= #regsad:NUMERIC#,emcsad= #emcsad:NUMERIC#,
		idesad= UPPER(#idesad:VARCHAR#),
		oemsad= UPPER(#oemsad:VARCHAR#),
		ufosad= UPPER(#ufosad:VARCHAR#),
		npasad= UPPER(#npasad:VARCHAR#),
		nmasad= UPPER(#nmasad:VARCHAR#),
		prosad= UPPER(#prosad:VARCHAR#),
		endsad= #endsad:NUMERIC#,
		emasad= #emasad:VARCHAR#,
		nirsad= UPPER(#nirsad:VARCHAR#),
		cnpsad= UPPER(#cnpsad:VARCHAR#),
		ncasad= UPPER(#ncasad:VARCHAR#),
		socsad= #socsad:NUMERIC#,
		admsad= #admsad:NUMERIC#,
		adesad= UPPER(#adesad:VARCHAR#),
		dddsad= UPPER(#dddsad:VARCHAR#),
		telsad= UPPER(#telsad:VARCHAR#),
		matsad = #matsad:NUMERIC#,
		tdcsad = #tdcsad:VARCHAR#,
		baesad = #baesad:NUMERIC#,
		qsisad = #qsisad:VARCHAR#
		WHERE 
		iddsad = #iddsad:NUMERIC#
	</update>
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM fcn.fcnsad WHERE iddsad = #value:NUMERIC#
	</delete>
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM fcn.fcnsad WHERE iddsad in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="SadVO"
		resultClass="Integer">
		SELECT count(iddsad) FROM fcn.fcnsad
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddsad" prepend=" AND "> iddsad =
				#iddsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nomsad" prepend=" AND ">
				nomsad ILIKE '%' || #nomsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="tipsad" prepend=" AND ">
				tipsad ILIKE '%' || #tipsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cpfsad" prepend=" AND ">
				cpfsad ILIKE '%' || #cpfsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="estsad" prepend=" AND "> estsad =
				#estsad:NUMERIC#
			</isNotNull>
			<isNotNull property="nacsad" prepend=" AND "> nacsad =
				#nacsad:NUMERIC#
			</isNotNull>
			<isNotNull property="sexsad" prepend=" AND ">
				sexsad ILIKE '%' || #sexsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dnasad" prepend=" AND ">
				to_char(dnasad,'dd/MM/yyyy') =
				to_char(#dnasad:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="regsad" prepend=" AND "> regsad =
				#regsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emcsad" prepend=" AND "> emcsad =
				#emcsad:NUMERIC#
			</isNotNull>
			<isNotNull property="idesad" prepend=" AND ">
				idesad ILIKE '%' || #idesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="oemsad" prepend=" AND ">
				oemsad ILIKE '%' || #oemsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ufosad" prepend=" AND ">
				ufosad ILIKE '%' || #ufosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="npasad" prepend=" AND ">
				npasad ILIKE '%' || #npasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nmasad" prepend=" AND ">
				nmasad ILIKE '%' || #nmasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="prosad" prepend=" AND ">
				prosad ILIKE '%' || #prosad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="endsad" prepend=" AND "> endsad =
				#endsad:NUMERIC#
			</isNotNull>
			<isNotNull property="emasad" prepend=" AND ">
				emasad ILIKE '%' || #emasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="nirsad" prepend=" AND ">
				nirsad ILIKE '%' || #nirsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="cnpsad" prepend=" AND ">
				cnpsad ILIKE '%' || #cnpsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="ncasad" prepend=" AND ">
				ncasad ILIKE '%' || #ncasad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="socsad" prepend=" AND "> socsad =
				#socsad:NUMERIC#
			</isNotNull>
			<isNotNull property="admsad" prepend=" AND "> admsad =
				#admsad:NUMERIC#
			</isNotNull>
			<isNotNull property="adesad" prepend=" AND ">
				adesad ILIKE '%' || #adesad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="dddsad" prepend=" AND ">
				dddsad ILIKE '%' || #dddsad:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="telsad" prepend=" AND ">
				telsad ILIKE '%' || #telsad:VARCHAR# || '%'
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="getRegByMatriz" parameterClass="Long" resultClass="SadVO">
		SELECT 
			* 
		FROM 
			fcn.fcnsad sad
		where 
			sad.matsad = #value:NUMERIC#
	</select>
	
	<select id="getSadByMatriz" parameterClass="Long" resultClass="hashmap">
		select 
			sad.iddsad, sad.nomsad, fcn.formataCpfCnpj(sad.cpfsad) as cpfsad, case when sad.cpfsad is not null then true else false end as iscpf,
			case when sad.cnpsad is not null then true else false end as iscnpj,
			tabecv.destab as estsad, tabnac.destab as nacsad, case when sad.sexsad = 'M' then 'Masculino' else 'Feminino' end as sexsad, to_char(sad.dnasad, 'dd/MM/yyyy') as dnasad, 
			tabreg.destab as regsad, tabema.destab as emcsad, sad.idesad, sad.oemsad, sad.ufosad, sad.npasad, 
			sad.nmasad, sad.prosad, sad.endsad, sad.emasad, sad.nirsad, fcn.formataCpfCnpj(sad.cnpsad) as cnpsad, 
			sad.ncasad, sad.adesad, sad.dddsad, sad.telsad,
			case when sad.socsad is not null then true else false end as socio, tabsoc.destab as consoc, to_char(soc.dinsoc, 'dd/MM/yyyy') as dinsoc, 
			to_char(soc.dfisoc, 'dd/MM/yyyy') as dfisoc, fcn.formataValorJunta(soc.parsoc) as parsoc,
			case when sad.admsad is not null then true else false end as administrador, adm.caradm, tabadm.destab as conadm, 
			to_char(adm.dinadm, 'dd/MM/yyyy') as dinadm, to_char(adm.dfiadm, 'dd/MM/yyyy') as dfiadm, 
			to_char(adm.dsaadm, 'dd/MM/yyyy') as dsaadm, fcn.getEndereco(sad.endsad) as edrsad, 
			(select case when count(0) > 0 then true else false end from fcn.fcnrep where sadrep = sad.iddsad) as representante
		from 
			fcn.fcnsad sad 
			left join fcn.fcnsoc soc on soc.iddsoc = sad.socsad
			left join fcn.fcnadm adm on adm.iddadm = sad.admsad
			left join fcn.fcntab tabsoc on (tabsoc.tabtab = 'CONSOC' AND tabsoc.codtab = cast(soc.consoc as varchar))
			left join fcn.fcntab tabadm on (tabadm.tabtab = 'CONADM' AND tabadm.codtab = cast(adm.conadm as varchar))
			left join fcn.fcntab tabecv on (tabecv.tabtab = 'ESTCIV' AND tabecv.codtab = cast(sad.estsad as varchar))
			left join fcn.fcntab tabnac on (tabnac.tabtab = 'PAIS' AND tabnac.codtab = cast(sad.nacsad as varchar))
			left join fcn.fcntab tabreg on (tabreg.tabtab = 'REGBEN' AND tabreg.codtab = cast(sad.regsad as varchar))
			left join fcn.fcntab tabema on (tabema.tabtab = 'FOREMA' AND tabema.codtab = cast(sad.emcsad as varchar))
		where 
			sad.matsad = #value:NUMERIC#
	</select>
	
	<select id="getSadByBae" parameterClass="Long" resultClass="hashmap">
		select 
			sad.iddsad, sad.nomsad, fcn.formataCpfCnpj(sad.cpfsad) as cpfsad, case when sad.cpfsad is not null then true else false end as iscpf,
			case when sad.cnpsad is not null then true else false end as iscnpj,
			tabecv.destab as estsad, tabnac.destab as nacsad, case when sad.sexsad = 'M' then 'Masculino' else 'Feminino' end as sexsad, to_char(sad.dnasad, 'dd/MM/yyyy') as dnasad, 
			tabreg.destab as regsad, tabema.destab as emcsad, sad.idesad, sad.oemsad, sad.ufosad, sad.npasad, 
			sad.nmasad, sad.prosad, sad.endsad, sad.emasad, sad.nirsad, fcn.formataCpfCnpj(sad.cnpsad) as cnpsad, 
			sad.ncasad, sad.adesad, sad.dddsad, sad.telsad,
			case when sad.socsad is not null then true else false end as socio, tabsoc.destab as consoc, to_char(soc.dinsoc, 'dd/MM/yyyy') as dinsoc, 
			to_char(soc.dfisoc, 'dd/MM/yyyy') as dfisoc, fcn.formataValorJunta(soc.parsoc) as parsoc,
			case when sad.admsad is not null then true else false end as administrador, adm.caradm, tabadm.destab as conadm, 
			to_char(adm.dinadm, 'dd/MM/yyyy') as dinadm, to_char(adm.dfiadm, 'dd/MM/yyyy') as dfiadm, 
			to_char(adm.dsaadm, 'dd/MM/yyyy') as dsaadm, fcn.getEndereco(sad.endsad) as edrsad, 
			(select case when count(0) > 0 then true else false end from fcn.fcnrep where sadrep = sad.iddsad) as representante
		from 
			fcn.fcnsad sad 
			left join fcn.fcnsoc soc on soc.iddsoc = sad.socsad
			left join fcn.fcnadm adm on adm.iddadm = sad.admsad
			left join fcn.fcntab tabsoc on (tabsoc.tabtab = 'CONSOC' AND tabsoc.codtab = cast(soc.consoc as varchar))
			left join fcn.fcntab tabadm on (tabadm.tabtab = 'CONADM' AND tabadm.codtab = cast(adm.conadm as varchar))
			left join fcn.fcntab tabecv on (tabecv.tabtab = 'ESTCIV' AND tabecv.codtab = cast(sad.estsad as varchar))
			left join fcn.fcntab tabnac on (tabnac.tabtab = 'PAIS' AND tabnac.codtab = cast(sad.nacsad as varchar))
			left join fcn.fcntab tabreg on (tabreg.tabtab = 'REGBEN' AND tabreg.codtab = cast(sad.regsad as varchar))
			left join fcn.fcntab tabema on (tabema.tabtab = 'FOREMA' AND tabema.codtab = cast(sad.emcsad as varchar))
		where 
			sad.baesad = #value:NUMERIC#
	</select>
	
	<select id="getRegByBae" parameterClass="Long" resultClass="SadVO">
		select 
			sad.* 
		from 
			fcn.fcnsad sad
			join fcn.fcnbae bae on bae.iddbae = sad.baesad
		where 
			bae.iddbae = #value:NUMERIC#
	</select>
	
</sqlMap> 
 