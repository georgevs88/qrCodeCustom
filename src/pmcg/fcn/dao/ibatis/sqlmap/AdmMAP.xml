<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Adm">
	<typeAlias alias="AdmVO" type="pmcg.fcn.domain.AdmVO" />


	<resultMap id="mapComplexQuerySimple" class="AdmVO">
		<result property="iddadm" column="iddadm" />
		<result property="caradm" column="caradm" />
		<result property="conadm" column="conadm" />
		<result property="dinadm" column="dinadm" />
		<result property="dfiadm" column="dfiadm" />
		<result property="dsaadm" column="dsaadm" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="AdmVO">
		<result property="iddadm" column="iddadm" />
		<result property="caradm" column="caradm" />
		<result property="conadm" column="conadm" />
		<result property="dinadm" column="dinadm" />
		<result property="dfiadm" column="dfiadm" />
		<result property="dsaadm" column="dsaadm" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM FCN.FCNADM WHERE iddadm = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM FCN.FCNADM WHERE iddadm = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="AdmVO"
		resultMap="mapComplexQuerySimple">
		SELECT * FROM FCN.FCNADM
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddadm" prepend=" AND ">
				iddadm = #iddadm:NUMERIC#
			</isNotNull>
			<isNotNull property="caradm" prepend=" AND ">
				caradm ILIKE '%' || #caradm:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="conadm" prepend=" AND ">
				conadm = #conadm:NUMERIC#
			</isNotNull>
			<isNotNull property="dinadm" prepend=" AND ">
				to_char(dinadm,'dd/MM/yyyy') =
				to_char(#dinadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfiadm" prepend=" AND ">
				to_char(dfiadm,'dd/MM/yyyy') =
				to_char(#dfiadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dsaadm" prepend=" AND ">
				to_char(dsaadm,'dd/MM/yyyy') =
				to_char(#dsaadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="AdmVO"
		resultMap="mapComplexQuery">
		SELECT * FROM FCN.FCNADM
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddadm" prepend=" AND "> iddadm =
				#iddadm:NUMERIC#
			</isNotNull>
			<isNotNull property="caradm" prepend=" AND ">
				caradm ILIKE '%' || #caradm:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="conadm" prepend=" AND "> conadm =
				#conadm:NUMERIC#
			</isNotNull>
			<isNotNull property="dinadm" prepend=" AND ">
				to_char(dinadm,'dd/MM/yyyy') =
				to_char(#dinadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfiadm" prepend=" AND ">
				to_char(dfiadm,'dd/MM/yyyy') =
				to_char(#dfiadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dsaadm" prepend=" AND ">
				to_char(dsaadm,'dd/MM/yyyy') =
				to_char(#dsaadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM FCN.FCNADM
	</select>

	<insert id="insReg" parameterClass="AdmVO">
		<selectKey keyProperty="iddadm" resultClass="Long">
			SELECT NEXTVAL('fcn.seqadm')
		</selectKey>
		INSERT INTO FCN.FCNADM(iddadm,caradm,conadm,dinadm,dfiadm,dsaadm) VALUES
		(#iddadm:NUMERIC#,
		UPPER(#caradm:VARCHAR#),#conadm:NUMERIC#,#dinadm:TIMESTAMP#,#dfiadm:TIMESTAMP#,#dsaadm:TIMESTAMP#
		)
	</insert>

	<update id="updRegByCod" parameterClass="AdmVO">
		UPDATE FCN.FCNADM SET caradm= UPPER(#caradm:VARCHAR#),conadm=
		#conadm:NUMERIC#,dinadm= #dinadm:TIMESTAMP#,dfiadm=
		#dfiadm:TIMESTAMP#,dsaadm= #dsaadm:TIMESTAMP# WHERE iddadm =
		#iddadm:NUMERIC#
	</update>
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM FCN.FCNADM WHERE iddadm = #value:NUMERIC#
	</delete>
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM FCN.FCNADM WHERE iddadm in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="AdmVO"
		resultClass="Integer">
		SELECT count(iddadm) FROM FCN.FCNADM
		<dynamic prepend=" WHERE ">
			<isNotNull property="iddadm" prepend=" AND "> iddadm =
				#iddadm:NUMERIC#
			</isNotNull>
			<isNotNull property="caradm" prepend=" AND ">
				caradm ILIKE '%' || #caradm:VARCHAR# || '%'
			</isNotNull>
			<isNotNull property="conadm" prepend=" AND "> conadm =
				#conadm:NUMERIC#
			</isNotNull>
			<isNotNull property="dinadm" prepend=" AND ">
				to_char(dinadm,'dd/MM/yyyy') =
				to_char(#dinadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dfiadm" prepend=" AND ">
				to_char(dfiadm,'dd/MM/yyyy') =
				to_char(#dfiadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="dsaadm" prepend=" AND ">
				to_char(dsaadm,'dd/MM/yyyy') =
				to_char(#dsaadm:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
		</dynamic>
	</select>
</sqlMap> 
 