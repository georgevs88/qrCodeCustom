<?xml version="1.0" encoding="UTF-8"?> 
 <!DOCTYPE sqlMap PUBLIC "//iBATIS.com//DTD SQL Map 2.0//EN" "HTTP://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Cid">
	<typeAlias alias="CidVO" type="pmcg.imti.domain.CidVO" />

	<resultMap id="mapComplexQuerySimple" class="CidVO">
		<result property="codcid" column="codcid" />
		<result property="nomcom" column="nomcom" />
		<result property="nomres" column="nomres" />
		<result property="codest" column="codest" />
		<result property="datalt" column="datalt" />
		<result property="codusualt" column="codusualt" />
		<result property="numver" column="numver" />
		<result property="codcidant" column="codcidant" />
		<result property="codsiafi" column="codsiafi" />
	</resultMap>

	<resultMap id="mapComplexQuery" class="CidVO">
		<result property="codcid" column="codcid" />
		<result property="nomcom" column="nomcom" />
		<result property="nomres" column="nomres" />
		<result property="codest" column="codest" />
		<result property="datalt" column="datalt" />
		<result property="codusualt" column="codusualt" />
		<result property="numver" column="numver" />
		<result property="codcidant" column="codcidant" />
		<result property="codsiafi" column="codsiafi" />
	</resultMap>

	<select id="getRegByCod" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT * FROM siatcgr.tblcid WHERE codcid = #value:NUMERIC#
	</select>

	<select id="getRegByCodComplex" parameterClass="Long" resultMap="mapComplexQuery">
		SELECT * FROM siatcgr.tblcid WHERE codcid = #value:NUMERIC#
	</select>

	<select id="getRegByCriterio" parameterClass="CidVO" resultMap="mapComplexQuerySimple">
		SELECT * FROM siatcgr.tblcid
		<dynamic prepend=" WHERE ">
			<isNotNull property="codcid" prepend=" AND ">
				codcid = #codcid:NUMERIC#
			</isNotNull>
			<isNotNull property="nomcom" prepend=" AND ">
				UPPER(nomcom) LIKE '%' || UPPER(#nomcom:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="nomres" prepend=" AND ">
				UPPER(nomres) LIKE '%' || UPPER(#nomres:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="codest" prepend=" AND ">
				codest = #codest:NUMERIC#
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="codusualt" prepend=" AND ">
				UPPER(codusualt) LIKE '%' || UPPER(#codusualt:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="numver" prepend=" AND ">
				numver = #numver:NUMERIC#
			</isNotNull>
			<isNotNull property="codcidant" prepend=" AND ">
				codcidant = #codcidant:NUMERIC#
			</isNotNull>
			<isNotNull property="codsiafi" prepend=" AND ">
				codsiafi = #codsiafi:NUMERIC#
			</isNotNull>
		</dynamic>
	</select>

	<select id="getRegByCriterioComplex" parameterClass="CidVO" resultMap="mapComplexQuery">
		SELECT * FROM siatcgr.tblcid
		<dynamic prepend=" WHERE ">
			<isNotNull property="codcid" prepend=" AND "> codcid = #codcid:NUMERIC#
			</isNotNull>
			<isNotNull property="nomcom" prepend=" AND ">
				UPPER(nomcom) LIKE '%' || UPPER(#nomcom:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="nomres" prepend=" AND ">
				UPPER(nomres) LIKE '%' || UPPER(#nomres:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="codest" prepend=" AND "> codest = #codest:NUMERIC#
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="codusualt" prepend=" AND ">
				UPPER(codusualt) LIKE '%' || UPPER(#codusualt:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="numver" prepend=" AND "> numver = #numver:NUMERIC#
			</isNotNull>
			<isNotNull property="codcidant" prepend=" AND "> codcidant = #codcidant:NUMERIC#
			</isNotNull>
			<isNotNull property="codsiafi" prepend=" AND "> codsiafi = #codsiafi:NUMERIC#
			</isNotNull>
		</dynamic>
	</select>

	<select id="getTodos" resultMap="mapComplexQuerySimple">
		SELECT * FROM siatcgr.tblcid
	</select>

	<insert id="insReg" parameterClass="CidVO">
		<selectKey keyProperty="codcid" resultClass="Long">
			SELECT siatcgr.seqcid.nextval from dual
		</selectKey>
		INSERT INTO siatcgr.tblcid(codcid,nomcom,nomres,codest,datalt,codusualt,numver,codcidant,codsiafi) VALUES
		(#codcid:NUMERIC#, UPPER(#nomcom:VARCHAR#), UPPER(#nomres:VARCHAR#),#codest:NUMERIC#,sysdate,
		UPPER(#codusualt:VARCHAR#),#numver:NUMERIC#,#codcidant:NUMERIC#,#codsiafi:NUMERIC# )
	</insert>

	<update id="updRegByCod" parameterClass="CidVO">
		UPDATE siatcgr.tblcid SET nomcom= UPPER(#nomcom:VARCHAR#),nomres= UPPER(#nomres:VARCHAR#),codest= #codest:NUMERIC#,datalt=
		sysdate,codusualt= UPPER(#codusualt:VARCHAR#),numver= #numver:NUMERIC#,codcidant= #codcidant:NUMERIC#,codsiafi=
		#codsiafi:NUMERIC# WHERE codcid = #codcid:NUMERIC#
	</update>
	
	<delete id="delByCod" parameterClass="Long">
		DELETE FROM siatcgr.tblcid WHERE codcid = #value:NUMERIC#
	</delete>
	
	<delete id="delByCodigos" parameterClass="String">
		DELETE FROM siatcgr.tblcid WHERE codcid in ($value$)
	</delete>

	<select id="getCountByCriterio" parameterClass="CidVO" resultClass="Integer">
		SELECT count(codcid) FROM siatcgr.tblcid
		<dynamic prepend=" WHERE ">
			<isNotNull property="codcid" prepend=" AND "> codcid = #codcid:NUMERIC#
			</isNotNull>
			<isNotNull property="nomcom" prepend=" AND ">
				UPPER(nomcom) LIKE '%' || UPPER(#nomcom:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="nomres" prepend=" AND ">
				UPPER(nomres) LIKE '%' || UPPER(#nomres:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="codest" prepend=" AND "> codest = #codest:NUMERIC#
			</isNotNull>
			<isNotNull property="datalt" prepend=" AND "> to_char(datalt,'dd/MM/yyyy') =
				to_char(#datalt:TIMESTAMP#,'dd/MM/yyyy')
			</isNotNull>
			<isNotNull property="codusualt" prepend=" AND ">
				UPPER(codusualt) LIKE '%' || UPPER(#codusualt:VARCHAR#) || '%'
			</isNotNull>
			<isNotNull property="numver" prepend=" AND "> numver = #numver:NUMERIC#
			</isNotNull>
			<isNotNull property="codcidant" prepend=" AND "> codcidant = #codcidant:NUMERIC#
			</isNotNull>
			<isNotNull property="codsiafi" prepend=" AND "> codsiafi = #codsiafi:NUMERIC#
			</isNotNull>
		</dynamic>
	</select>
	
	<select id="getCidByEst" parameterClass="Long" resultMap="mapComplexQuerySimple">
		SELECT 
			* 
		FROM 
			siatcgr.tblcid
		WHERE 
			codest = #codest:NUMERIC#
	</select>
	
	<select id="getCidByEstado" parameterClass="String"	resultMap="mapComplexQuerySimple">
		select C.* 
		from SIATCGR.TBLCID C 
		join SIATCGR.TBLEST E ON c.codest = e.codest
		where e.unifed like #value:VARCHAR#
		order by c.nomcom 
	</select>
	
	<select id="getRegByNomUf" parameterClass="CidVO" resultMap="mapComplexQuerySimple">
		select 
			C.* 
		from 
			TBLCID C
		where 
			C.NOMCOM = UPPER(#nomcom:VARCHAR#)
			AND C.CODEST = #codest:NUMERIC#
	</select>
	
	<select id="getRegByCodSiafi" parameterClass="Integer" resultMap="mapComplexQuerySimple">
		select 
			C.* 
		from 
			TBLCID C
		where 
			C.CODSIAFI = #value:NUMERIC#
	</select>
</sqlMap> 
 